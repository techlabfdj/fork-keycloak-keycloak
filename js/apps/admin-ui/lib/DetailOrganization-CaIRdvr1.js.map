{"version":3,"file":"DetailOrganization-CaIRdvr1.js","sources":["../src/organizations/DetailOrganization.tsx"],"sourcesContent":["import {\n  FormSubmitButton,\n  useAlerts,\n  useFetch,\n} from \"@keycloak/keycloak-ui-shared\";\nimport {\n  ActionGroup,\n  Button,\n  PageSection,\n  Tab,\n  TabTitleText,\n} from \"@patternfly/react-core\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { useAdminClient } from \"../admin-client\";\nimport { FormAccess } from \"../components/form/FormAccess\";\nimport { AttributesForm } from \"../components/key-value-form/AttributeForm\";\nimport { arrayToKeyValue } from \"../components/key-value-form/key-value-convert\";\nimport {\n  RoutableTabs,\n  useRoutableTab,\n} from \"../components/routable-tabs/RoutableTabs\";\nimport { useRealm } from \"../context/realm-context/RealmContext\";\nimport { useParams } from \"../utils/useParams\";\nimport { DetailOrganizationHeader } from \"./DetailOraganzationHeader\";\nimport { IdentityProviders } from \"./IdentityProviders\";\nimport { Members } from \"./Members\";\nimport {\n  OrganizationForm,\n  OrganizationFormType,\n  convertToOrg,\n} from \"./OrganizationForm\";\nimport {\n  EditOrganizationParams,\n  OrganizationTab,\n  toEditOrganization,\n} from \"./routes/EditOrganization\";\n\nexport default function DetailOrganization() {\n  const { adminClient } = useAdminClient();\n  const { addAlert, addError } = useAlerts();\n\n  const { realm } = useRealm();\n  const { id } = useParams<EditOrganizationParams>();\n  const { t } = useTranslation();\n\n  const form = useForm<OrganizationFormType>();\n\n  const save = async (org: OrganizationFormType) => {\n    try {\n      const organization = convertToOrg(org);\n      await adminClient.organizations.updateById({ id }, organization);\n      addAlert(t(\"organizationSaveSuccess\"));\n    } catch (error) {\n      addError(\"organizationSaveError\", error);\n    }\n  };\n\n  useFetch(\n    () => adminClient.organizations.findOne({ id }),\n    (org) => {\n      if (!org) {\n        throw new Error(t(\"notFound\"));\n      }\n      form.reset({\n        ...org,\n        domains: org.domains?.map((d) => d.name),\n        attributes: arrayToKeyValue(org.attributes),\n      });\n    },\n    [id],\n  );\n\n  const useTab = (tab: OrganizationTab) =>\n    useRoutableTab(\n      toEditOrganization({\n        realm,\n        id,\n        tab,\n      }),\n    );\n\n  const settingsTab = useTab(\"settings\");\n  const attributesTab = useTab(\"attributes\");\n  const membersTab = useTab(\"members\");\n  const identityProvidersTab = useTab(\"identityProviders\");\n\n  return (\n    <PageSection variant=\"light\" className=\"pf-v5-u-p-0\">\n      <FormProvider {...form}>\n        <DetailOrganizationHeader save={() => save(form.getValues())} />\n        <RoutableTabs\n          data-testid=\"organization-tabs\"\n          aria-label={t(\"organization\")}\n          isBox\n          mountOnEnter\n        >\n          <Tab\n            id=\"settings\"\n            data-testid=\"settingsTab\"\n            title={<TabTitleText>{t(\"settings\")}</TabTitleText>}\n            {...settingsTab}\n          >\n            <PageSection>\n              <FormAccess\n                role=\"anyone\"\n                onSubmit={form.handleSubmit(save)}\n                isHorizontal\n              >\n                <OrganizationForm readOnly />\n                <ActionGroup>\n                  <FormSubmitButton\n                    formState={form.formState}\n                    data-testid=\"save\"\n                  >\n                    {t(\"save\")}\n                  </FormSubmitButton>\n                  <Button\n                    onClick={() => form.reset()}\n                    data-testid=\"reset\"\n                    variant=\"link\"\n                  >\n                    {t(\"reset\")}\n                  </Button>\n                </ActionGroup>\n              </FormAccess>\n            </PageSection>\n          </Tab>\n          <Tab\n            id=\"attributes\"\n            data-testid=\"attributeTab\"\n            title={<TabTitleText>{t(\"attributes\")}</TabTitleText>}\n            {...attributesTab}\n          >\n            <PageSection variant=\"light\">\n              <AttributesForm\n                form={form}\n                save={save}\n                reset={() =>\n                  form.reset({\n                    ...form.getValues(),\n                  })\n                }\n                name=\"attributes\"\n              />\n            </PageSection>\n          </Tab>\n          <Tab\n            id=\"members\"\n            data-testid=\"membersTab\"\n            title={<TabTitleText>{t(\"members\")}</TabTitleText>}\n            {...membersTab}\n          >\n            <Members />\n          </Tab>\n          <Tab\n            id=\"identityProviders\"\n            data-testid=\"identityProvidersTab\"\n            title={<TabTitleText>{t(\"identityProviders\")}</TabTitleText>}\n            {...identityProvidersTab}\n          >\n            <IdentityProviders />\n          </Tab>\n        </RoutableTabs>\n      </FormProvider>\n    </PageSection>\n  );\n}\n"],"names":["DetailOrganization","adminClient","useAdminClient","addAlert","addError","useAlerts","realm","useRealm","id","useParams","t","useTranslation","form","useForm","save","org","organization","convertToOrg","error","useFetch","d","arrayToKeyValue","useTab","tab","useRoutableTab","toEditOrganization","settingsTab","attributesTab","membersTab","identityProvidersTab","jsx","PageSection","jsxs","FormProvider","DetailOrganizationHeader","RoutableTabs","Tab","TabTitleText","FormAccess","OrganizationForm","ActionGroup","FormSubmitButton","Button","AttributesForm","Members","IdentityProviders"],"mappings":"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"}